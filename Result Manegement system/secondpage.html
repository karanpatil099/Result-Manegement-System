<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Details</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            margin-top: 50px;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .table {
            margin-top: 20px;
        }
        .notification-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .notification-btn:hover {
            transform: scale(1.1);
        }
        .modal-footer {
            display: flex;
            justify-content: space-between;
        }
        .modal-content {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Student Details</h1>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody id="studentDetails">
                <!-- Student details will be populated here -->
            </tbody>
        </table>
        <a href="admin dashboard.html" class="btn btn-secondary">Add Another Student</a>
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Edit Student</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <div class="form-group">
                            <label for="editName">Name:</label>
                            <input type="text" class="form-control" id="editName" required>
                        </div>
                        <div class="form-group">
                            <label for="editRollNumber">Roll Number:</label>
                            <input type="number" class="form-control" id="editRollNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="editdbms">Economics and Management Marks:</label>
                            <input type="number" class="form-control" id="editdbms" required>
                        </div>
                        <div class="form-group">
                            <label for="editToc">Theory of Computation Marks:</label>
                            <input type="number" class="form-control" id="editToc" required>
                        </div>
                        <div class="form-group">
                            <label for="editNm">Numerical Method Marks:</label>
                            <input type="number" class="form-control" id="editNm" required>
                        </div>
                        <div class="form-group">
                            <label for="editSe">Software Engineering Marks:</label>
                            <input type="number" class="form-control" id="editSe" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="saveChanges()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div aria-live="polite" aria-atomic="true" style="position: absolute; top: 0; right: 0; min-height: 100px; z-index: 9999;">
        <div class="toast" id="toastNotification" style="position: absolute; top: 10px; right: 10px;">
            <div class="toast-header">
                <strong class="mr-auto">Notification</strong>
                <button type="button" class="ml-2 mb-1 close" data-dismiss="toast">&times;</button>
            </div>
            <div class="toast-body" id="toastMessage">
                <!-- Message will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Notification Button -->
    <button class="notification-btn" onclick="showToast('This is a sample notification!')">Show Notification</button>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        let editingIndex = null; // To keep track of the currently editing student
        const students = JSON.parse(localStorage.getItem('students')) || [];
        console.log("data are :- ",students);
        const details = document.getElementById('studentDetails');

        const toastNotification = $('#toastNotification');

        // Populate the table
        function populateTable() {
            details.innerHTML = '';
            if (students.length > 0) {
                students.forEach((student, index) => {
                    details.innerHTML += `  
                        <tr><td colspan="2"><strong>Student ${index + 1}</strong></td></tr>
                        <tr><td>Name</td><td>${student.name}</td></tr>
                        <tr><td>Roll Number</td><td>${student.rollNumber}</td></tr>
                        <tr><td>Economics and Management Marks</td><td>${student.dbms}</td></tr>
                        <tr><td>Theory of Computation Marks</td><td>${student.toc}</td></tr>
                        <tr><td>Numerical Method Marks</td><td>${student.nm}</td></tr>
                        <tr><td>Software Engineering Marks</td><td>${student.se}</td></tr>
                        <tr><td>Total Marks</td><td>${parseInt(student.dbms) + parseInt(student.toc) + parseInt(student.nm) + parseInt(student.se)}</td></tr>
                        <tr><td>Percentage</td><td>${(((parseInt(student.dbms) + parseInt(student.toc) + parseInt(student.nm) + parseInt(student.se)) * 100) / 400).toFixed(2)}%</td></tr>
                        <tr>
                            <td colspan="2" class="text-center">
                                <button class="btn btn-primary btn-sm" onclick="editStudent(${index})">Edit</button>
                                <button class="btn btn-danger btn-sm" onclick="deleteStudent(${index})">Delete</button>
                            </td>
                        </tr>
                    `;
                });
            } else {
                details.innerHTML = `<tr><td colspan="2">No student data available</td></tr> `;

            }
        }

        // Populate table on load
        populateTable();

        // Delete student
        function deleteStudent(index) {
            if (confirm('Are you sure you want to delete this student?')) {
                students.splice(index, 1);
                localStorage.setItem('students', JSON.stringify(students));
                populateTable();
                showToast('Student deleted successfully');
            }
        }

        // Edit student
        function editStudent(index) {
            editingIndex = index;
            const student = students[index];

            document.getElementById('editName').value = student.name;
            document.getElementById('editRollNumber').value = student.rollNumber;
            document.getElementById('editdbms').value = student.dbms;
            document.getElementById('editToc').value = student.toc;
            document.getElementById('editNm').value = student.nm;
            document.getElementById('editSe').value = student.se;

            $('#editModal').modal('show'); 
        }

        // Save changes
        function saveChanges() {
            const updatedStudent = {
                name: document.getElementById('editName').value,
                rollNumber: document.getElementById('editRollNumber').value,
                dbms: document.getElementById('editdbms').value,
                toc: document.getElementById('editToc').value,
                nm: document.getElementById('editNm').value,
                se: document.getElementById('editSe').value,
            };

            students[editingIndex] = updatedStudent;
            localStorage.setItem('students', JSON.stringify(students));
            populateTable();
            $('#editModal').modal('hide');
            showToast('Student details updated successfully');
        }

        function showToast(message) {
            $('#toastMessage').text(message);
            toastNotification.toast('show');
        }
    </script>
</body>
</html>
